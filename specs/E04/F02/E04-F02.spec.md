# Spec: E04-F02 - Property Panel

## Metadata
- **ID**: E04-F02
- **Type**: Feature
- **Priority**: P0 (MVP)
- **Status**: Draft
- **Parent**: [E04](../E04.spec.md)
- **Created**: 2025-12-26
- **Estimated Hours**:
- **Actual Hours**:
- **Effort**:
- **Tags**: []

---

## 1. Overview

### 1.1 Problem Statement

After selecting schematic objects, circuit designers need to immediately view detailed properties to understand the object's characteristics, connectivity, and role in the circuit. The property panel must display context-specific information based on object type (cell, pin, net, or port) and update instantly when selection changes.

### 1.2 Goals

- Display detailed properties for selected objects within 50ms
- Show type-specific attributes for cells, pins, nets, and ports
- Support multi-selection property display
- Provide clear, organized property presentation
- Enable copy-to-clipboard for property values

---

## 2. User Stories

### US-E04-03: Property Inspection
**As a** circuit designer
**I want to** see details of selected objects
**So that** I can understand their attributes

**Acceptance Criteria:**
- [ ] Cell properties: name, type, pin count, sequential flag
- [ ] Pin properties: name, direction, connected net
- [ ] Net properties: name, fanout count, connected pins
- [ ] Port properties: name, direction, external connection

---

## 3. Technical Requirements

### 3.1 Property Data Structures

```python
@dataclass
class CellProperties:
    """Properties displayed for cell objects"""
    name: str
    cell_type: str
    pin_count: int
    is_sequential: bool
    input_pins: List[str]
    output_pins: List[str]
    inout_pins: List[str]

@dataclass
class PinProperties:
    """Properties displayed for pin objects"""
    name: str
    direction: PinDirection  # INPUT, OUTPUT, INOUT
    parent_cell: str
    connected_net: Optional[str]
    net_fanout: Optional[int]

@dataclass
class NetProperties:
    """Properties displayed for net objects"""
    name: str
    driver: Optional[Pin]  # Source pin
    fanout: List[Pin]      # Sink pins
    fanout_count: int
    is_power_net: bool
    is_ground_net: bool

@dataclass
class PortProperties:
    """Properties displayed for port objects"""
    name: str
    direction: PinDirection
    connected_net: Optional[str]
    is_top_level: bool
```

### 3.2 Property Panel UI Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Property Inspector            [ðŸ“‹]  â”‚ â† Header with copy button
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Object Type: Cell                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ General                             â”‚
â”‚   Name:          U_ALU_ADD_1        â”‚
â”‚   Cell Type:     NAND2_X1           â”‚
â”‚   Sequential:    No                 â”‚
â”‚   Pin Count:     4                  â”‚
â”‚                                     â”‚
â”‚ Pins                                â”‚
â”‚   Inputs:  A, B                     â”‚
â”‚   Outputs: Y                        â”‚
â”‚   Power:   VDD, VSS                 â”‚
â”‚                                     â”‚
â”‚ Connectivity                        â”‚
â”‚   Fanin:         2 cells            â”‚
â”‚   Fanout:        3 cells            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Multi-Selection Display

When multiple objects are selected:
- Display count: "3 objects selected"
- Show common properties if same type
- Show "Mixed" for differing values
- List individual object names

### 3.4 Property Query Service

```python
class PropertyQueryService:
    """Application service for querying object properties"""

    def get_cell_properties(self, cell_id: CellId) -> CellProperties:
        """Query cell properties from domain model"""

    def get_pin_properties(self, pin_id: PinId) -> PinProperties:
        """Query pin properties from domain model"""

    def get_net_properties(self, net_id: NetId) -> NetProperties:
        """Query net properties from domain model"""

    def get_port_properties(self, port_id: PortId) -> PortProperties:
        """Query port properties from domain model"""
```

### 3.5 Performance Targets

- Property panel update time: < 50ms after selection change
- Property query from domain model: < 10ms
- UI rendering of properties: < 40ms
- Support for multi-selection up to 100 objects

### 3.6 Integration Points

- **Selection Manager**: Listen to `selection_changed` signal
- **Domain Model**: Query object properties via application service
- **UI Panel**: Right-side dockable widget in main window
- **Clipboard**: Copy property values to system clipboard

---

## 4. Dependencies

- **Upstream**:
  - E04-F01 (Selection System - triggers property updates)
  - E01 (Data Model - provides object properties)
- **Downstream**:
  - None (terminal feature)

---

## 5. Acceptance Criteria

- [ ] Property panel displays cell properties: name, type, pin count, sequential flag, pin lists
- [ ] Property panel displays pin properties: name, direction, parent cell, connected net
- [ ] Property panel displays net properties: name, driver, fanout count, connected pins
- [ ] Property panel displays port properties: name, direction, connection status
- [ ] Panel updates within 50ms of selection change
- [ ] Multi-selection displays object count and common properties
- [ ] Copy button copies all properties to clipboard
- [ ] Panel is dockable and resizable
- [ ] Empty selection shows "No object selected" message
- [ ] Property groups are collapsible for space efficiency

---

## 6. Child Specs

| ID | Task | Status |
|----|------|--------|
| [E04-F02-T01](T01/E04-F02-T01.spec.md) | PropertyPanel Widget - QDockWidget with property display | Draft |
| [E04-F02-T02](T02/E04-F02-T02.spec.md) | Property Formatters - Format cell/pin/net/port properties | Draft |
| [E04-F02-T03](T03/E04-F02-T03.spec.md) | Selection Listener - Update panel on selection changes | Draft |
| [E04-F02-T04](T04/E04-F02-T04.spec.md) | Multi-Selection Summary - Aggregate info for multiple selections | Draft |

---

## Revision History

| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial feature creation from E04 split |
