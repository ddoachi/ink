# Spec: E06 - User Interface Shell

## Metadata
- **ID**: E06
- **Type**: Epic
- **Priority**: P0 (MVP)
- **Status**: Draft
- **PRD Sections**: §13.1 Main Window Layout
- **Created**: 2025-12-26
- **Parent**: [PRD](../../docs/prd.md)

---

## 1. Overview

This epic covers the main application window shell - the overall layout, panels, menus, and framework that contains all other UI components.

### 1.1 Problem Statement

Ink needs a well-organized interface that provides access to schematic visualization, object properties, search, and messages. The layout must be intuitive for engineers familiar with EDA tools.

### 1.2 Goals

- Create main window with standard EDA tool layout
- Central schematic canvas as primary workspace
- Dockable panels for hierarchy, properties, and messages
- Menu bar and toolbar for common actions
- Status bar for context information

---

## 2. User Stories

### US-E06-01: Main Window Layout
**As a** circuit designer
**I want to** see a familiar EDA tool layout
**So that** I can work productively from day one

**Acceptance Criteria:**
- [ ] Central area: Schematic canvas (largest)
- [ ] Left panel: Design hierarchy / object tree (collapsible)
- [ ] Right panel: Property inspector (collapsible)
- [ ] Bottom panel: Messages / search results (collapsible)
- [ ] Panels remember size and visibility

### US-E06-02: Menu Bar
**As a** circuit designer
**I want to** access functions via menus
**So that** I can discover available features

**Acceptance Criteria:**
- [ ] File menu: Open, Recent Files, Exit
- [ ] Edit menu: Undo, Redo, Find
- [ ] View menu: Zoom, Fit, Toggle panels
- [ ] Help menu: About, Keyboard shortcuts

### US-E06-03: Toolbar
**As a** circuit designer
**I want to** quick-access common actions
**So that** I can work efficiently

**Acceptance Criteria:**
- [ ] Open file button
- [ ] Zoom in/out buttons
- [ ] Fit view button
- [ ] Undo/redo buttons
- [ ] Search button

### US-E06-04: Status Bar
**As a** circuit designer
**I want to** see context information
**So that** I know current state

**Acceptance Criteria:**
- [ ] Loaded file name
- [ ] Zoom level percentage
- [ ] Selection count
- [ ] Cell/net count in view

### US-E06-05: Panel Docking
**As a** circuit designer
**I want to** rearrange panels
**So that** I can customize my workspace

**Acceptance Criteria:**
- [ ] Panels can be docked left, right, bottom
- [ ] Panels can be floated as separate windows
- [ ] Panels can be tabbed together
- [ ] Layout persists across sessions

### US-E06-06: Recent Files
**As a** circuit designer
**I want to** quickly open recent files
**So that** I can resume work efficiently

**Acceptance Criteria:**
- [ ] Last 10 files remembered
- [ ] Recent files in File menu
- [ ] Click to open directly
- [ ] Missing files handled gracefully

---

## 3. Technical Requirements

### 3.1 Main Window Structure

```python
class InkMainWindow(QMainWindow):
    # Central widget
    schematic_canvas: SchematicCanvas

    # Dock widgets
    hierarchy_dock: QDockWidget  # Left
    property_dock: QDockWidget   # Right
    message_dock: QDockWidget    # Bottom

    # Bars
    menu_bar: QMenuBar
    tool_bar: QToolBar
    status_bar: QStatusBar
```

### 3.2 Menu Structure

```
File
├── Open... (Ctrl+O)
├── Open Recent ►
│   ├── file1.ckt
│   ├── file2.ckt
│   └── Clear Recent
├── ─────────────
└── Exit (Ctrl+Q)

Edit
├── Undo (Ctrl+Z)
├── Redo (Ctrl+Shift+Z)
├── ─────────────
└── Find... (Ctrl+F)

View
├── Zoom In (Ctrl+=)
├── Zoom Out (Ctrl+-)
├── Fit View (Ctrl+0)
├── ─────────────
├── ☑ Hierarchy Panel
├── ☑ Property Panel
└── ☑ Message Panel

Help
├── Keyboard Shortcuts
├── ─────────────
└── About Ink
```

### 3.3 Settings Persistence

```python
class AppSettings:
    """Persisted via QSettings"""

    # Window geometry
    window_geometry: QByteArray
    window_state: QByteArray

    # Panel visibility
    hierarchy_visible: bool
    property_visible: bool
    message_visible: bool

    # Recent files
    recent_files: List[str]
    max_recent_files: int = 10
```

### 3.4 Application Entry Point

```python
def main():
    app = QApplication(sys.argv)
    app.setApplicationName("Ink")
    app.setOrganizationName("InkProject")

    window = InkMainWindow()
    window.show()

    sys.exit(app.exec())
```

---

## 4. Dependencies

- **Upstream**: None (foundation for all UI)
- **Downstream**:
  - E02 (Rendering - schematic canvas placement)
  - E04 (Interaction - property panel)
  - E05 (Search - search panel placement)
- **External**: PySide6 (Qt6 framework)

---

## 5. Risks & Mitigations

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Qt version compatibility | Medium | Low | Pin PySide6 version, test matrix |
| High DPI display issues | Low | Medium | Use Qt scaling, test on various displays |
| Settings migration | Low | Low | Version settings, handle migration |

---

## 6. Acceptance Criteria (Epic Level)

- [ ] Application launches in <2 seconds
- [ ] All panels dock and undock correctly
- [ ] Menu shortcuts work as specified
- [ ] Layout persists across restart
- [ ] Recent files list works correctly

---

## 7. Child Specs

*To be created via `/spec_work E06 --split features`*

| ID | Feature | Status |
|----|---------|--------|
| E06-F01 | Main Window Shell | Draft |
| E06-F02 | Menu System | Draft |
| E06-F03 | Toolbar | Draft |
| E06-F04 | Status Bar | Draft |
| E06-F05 | Panel Management | Draft |
| E06-F06 | Settings Persistence | Draft |

---

## Revision History

| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial epic creation from PRD split |
