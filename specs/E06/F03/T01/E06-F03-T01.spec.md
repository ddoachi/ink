---
id: E06-F03-T01
title: Toolbar Setup and Infrastructure
type: Task
priority: P0 (MVP)
status: Draft
parent: E06-F03
created: 2025-12-26
estimated_hours: 3
actual_hours:
effort: Small
tags:
  - ui
  - toolbar
  - infrastructure
clickup_task_id: ''
---

# Spec: E06-F03-T01 - Toolbar Setup and Infrastructure

## 1. Overview

### 1.1 Problem Statement

The main window needs a toolbar infrastructure to host action buttons for common operations. This includes creating the `QToolBar` widget, establishing the layout structure with logical groupings, and integrating the toolbar into the main window.

### 1.2 Goals

- Create `QToolBar` instance in main window
- Establish toolbar layout with separator groups (File, Edit, View, Search)
- Configure toolbar properties (fixed position, icon size, button style)
- Integrate toolbar into main window layout below menu bar
- Set up foundation for action button additions in subsequent tasks

---

## 2. Technical Requirements

### 2.1 Toolbar Initialization

**Location**: `src/ink/presentation/main_window.py`

```python
from PySide6.QtCore import QSize, Qt
from PySide6.QtWidgets import QToolBar

class InkMainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        self._setup_ui()
        self._setup_toolbar()  # Add toolbar setup

    def _setup_toolbar(self):
        """Create main toolbar with logical groupings."""
        toolbar = QToolBar("Main Toolbar", self)
        toolbar.setObjectName("MainToolBar")  # For QSettings persistence
        toolbar.setMovable(False)  # Fixed position for MVP
        toolbar.setIconSize(QSize(24, 24))  # Standard 24x24px icons
        toolbar.setToolButtonStyle(Qt.ToolButtonStyle.ToolButtonIconOnly)

        # Add toolbar to main window
        self.addToolBar(toolbar)

        # Store reference for action additions
        self._toolbar = toolbar

        # Set up logical groups (separators only, actions added in other tasks)
        self._setup_toolbar_groups()

    def _setup_toolbar_groups(self):
        """Create logical groupings with separators."""
        # File group placeholder (actions added in T02-T03)
        # self._toolbar.addSeparator() will be called after first group
        pass
```

### 2.2 Toolbar Configuration

**Properties to configure**:
- **Object name**: `"MainToolBar"` for settings persistence
- **Movable**: `False` (fixed position for MVP, customization in future)
- **Icon size**: `24x24` pixels (standard toolbar size)
- **Button style**: `ToolButtonIconOnly` (compact, icon-only display)
- **Placement**: Top toolbar area below menu bar

### 2.3 Group Structure

Toolbar will have 4 logical groups separated by `addSeparator()`:

1. **File Group**: File operations (Open button)
2. **Edit Group**: Undo/Redo operations
3. **View Group**: Zoom and view controls
4. **Search Group**: Search functionality

Separators are added programmatically when actions are added in tasks T02-T03.

### 2.4 Integration Points

- Must be called after `_setup_ui()` but before window show
- Toolbar reference (`self._toolbar`) stored as instance variable
- Provides public or protected methods for other tasks to add actions

---

## 3. Dependencies

### 3.1 Upstream Dependencies
- **E06-F01**: Main Window Shell (provides `InkMainWindow` class and layout)

### 3.2 Downstream Dependencies
- **E06-F03-T02**: View Control Tools (adds zoom/fit actions to toolbar)
- **E06-F03-T03**: Edit and Search Tools (adds undo/redo/search actions)
- **E06-F03-T04**: Icon Resources (provides icons for toolbar buttons)

### 3.3 External Dependencies
- PySide6: `QToolBar`, `QAction`, `QSize`
- Qt namespace: `Qt.ToolButtonStyle`

---

## 4. Acceptance Criteria

- [ ] `QToolBar` instance created with name "Main Toolbar"
- [ ] Toolbar has object name "MainToolBar" for settings persistence
- [ ] Toolbar is non-movable (`setMovable(False)`)
- [ ] Icon size set to 24x24 pixels
- [ ] Button style set to icon-only mode
- [ ] Toolbar attached to main window in top toolbar area
- [ ] Toolbar visible below menu bar when main window displayed
- [ ] Toolbar reference stored in instance variable (`self._toolbar`)
- [ ] Group separator infrastructure in place (ready for action additions)
- [ ] No runtime errors when main window launches with toolbar

---

## 5. Testing Strategy

### 5.1 Unit Tests

**Test file**: `tests/unit/presentation/test_main_window.py`

```python
def test_toolbar_created(main_window):
    """Test toolbar is created and attached to main window."""
    toolbar = main_window.findChild(QToolBar, "MainToolBar")
    assert toolbar is not None
    assert toolbar.windowTitle() == "Main Toolbar"

def test_toolbar_configuration(main_window):
    """Test toolbar has correct configuration."""
    toolbar = main_window.findChild(QToolBar, "MainToolBar")
    assert not toolbar.isMovable()
    assert toolbar.iconSize() == QSize(24, 24)
    assert toolbar.toolButtonStyle() == Qt.ToolButtonStyle.ToolButtonIconOnly

def test_toolbar_position(main_window):
    """Test toolbar is in top toolbar area."""
    toolbar = main_window.findChild(QToolBar, "MainToolBar")
    area = main_window.toolBarArea(toolbar)
    assert area == Qt.ToolBarArea.TopToolBarArea
```

### 5.2 Manual Testing

1. Launch application
2. Verify toolbar appears below menu bar
3. Verify toolbar is empty (no buttons yet, just infrastructure)
4. Verify toolbar cannot be dragged/moved
5. Verify toolbar has consistent height across window resize

---

## 6. Implementation Notes

### 6.1 Code Structure

- Add `_setup_toolbar()` method to `InkMainWindow` class
- Call `_setup_toolbar()` in `__init__` after `_setup_ui()`
- Store toolbar reference in `self._toolbar` for action additions
- Keep group separator logic minimal (actual actions added in T02-T03)

### 6.2 Future Enhancements

- Toolbar customization (show/hide, reorder buttons)
- Movable/floatable toolbar support
- Multiple toolbar support (separate view/edit toolbars)
- Toolbar state persistence via `QSettings`

---

## Revision History

| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial task spec creation from E06-F03 split |
