# Spec: E06-F03 - Toolbar

## Metadata
- **ID**: E06-F03
- **Type**: Feature
- **Priority**: P0 (MVP)
- **Status**: Draft
- **Parent**: [E06](../E06.spec.md)
- **Created**: 2025-12-26
- **Estimated Hours**:
- **Actual Hours**:
- **Effort**:
- **Tags**: []

---

## 1. Overview

### 1.1 Problem Statement

Power users need quick access to frequently-used commands without navigating through menus. A toolbar provides one-click access to common operations like file opening, zoom controls, undo/redo, and search, significantly improving workflow efficiency during schematic exploration sessions.

### 1.2 Goals

- Implement toolbar with icon-based quick access to common actions
- Provide visual feedback for toolbar button states
- Organize toolbar logically by function groups
- Support tooltips for discoverability
- Enable toolbar customization (future: hiding, repositioning)

---

## 2. User Stories

### US-E06-03: Toolbar
**As a** circuit designer
**I want to** quick-access common actions
**So that** I can work efficiently

**Acceptance Criteria:**
- [ ] Open file button
- [ ] Zoom in/out buttons
- [ ] Fit view button
- [ ] Undo/redo buttons
- [ ] Search button

---

## 3. Technical Requirements

### 3.1 Toolbar Layout

```
┌─────────────────────────────────────────────────────────────┐
│ [Open] │ [Undo] [Redo] │ [Zoom-] [Zoom+] [Fit] │ [Search] │
└─────────────────────────────────────────────────────────────┘
  File       Edit             View                  Search
  Group      Group            Group                 Group
```

Toolbar groups separated by visual separators (`QToolBar.addSeparator()`).

### 3.2 Toolbar Implementation

```python
# src/ink/presentation/main_window.py (extension)

from PySide6.QtGui import QIcon
from PySide6.QtWidgets import QToolBar

class InkMainWindow(QMainWindow):
    def _setup_toolbar(self):
        """Create main toolbar with action buttons."""
        toolbar = QToolBar("Main Toolbar", self)
        toolbar.setObjectName("MainToolBar")  # For settings persistence
        toolbar.setMovable(False)  # Fixed position for MVP
        self.addToolBar(toolbar)

        # File Group
        self._add_file_actions(toolbar)
        toolbar.addSeparator()

        # Edit Group
        self._add_edit_actions(toolbar)
        toolbar.addSeparator()

        # View Group
        self._add_view_actions(toolbar)
        toolbar.addSeparator()

        # Search Group
        self._add_search_actions(toolbar)

    def _add_file_actions(self, toolbar: QToolBar):
        """Add file-related toolbar actions."""
        # Open file button
        open_action = QAction(QIcon.fromTheme("document-open"), "Open", self)
        open_action.setToolTip("Open netlist file (Ctrl+O)")
        open_action.setShortcut(QKeySequence.StandardKey.Open)
        open_action.triggered.connect(self._on_open_file)
        toolbar.addAction(open_action)

    def _add_edit_actions(self, toolbar: QToolBar):
        """Add edit-related toolbar actions."""
        # Undo button
        self.undo_action = QAction(QIcon.fromTheme("edit-undo"), "Undo", self)
        self.undo_action.setToolTip("Undo expansion/collapse (Ctrl+Z)")
        self.undo_action.setShortcut(QKeySequence.StandardKey.Undo)
        self.undo_action.setEnabled(False)
        toolbar.addAction(self.undo_action)

        # Redo button
        self.redo_action = QAction(QIcon.fromTheme("edit-redo"), "Redo", self)
        self.redo_action.setToolTip("Redo expansion/collapse (Ctrl+Shift+Z)")
        self.redo_action.setShortcut(QKeySequence.StandardKey.Redo)
        self.redo_action.setEnabled(False)
        toolbar.addAction(self.redo_action)

    def _add_view_actions(self, toolbar: QToolBar):
        """Add view-related toolbar actions."""
        # Zoom out button
        zoom_out_action = QAction(QIcon.fromTheme("zoom-out"), "Zoom Out", self)
        zoom_out_action.setToolTip("Zoom out (Ctrl+-)")
        zoom_out_action.setShortcut(QKeySequence.StandardKey.ZoomOut)
        zoom_out_action.triggered.connect(self._on_zoom_out)
        toolbar.addAction(zoom_out_action)

        # Zoom in button
        zoom_in_action = QAction(QIcon.fromTheme("zoom-in"), "Zoom In", self)
        zoom_in_action.setToolTip("Zoom in (Ctrl+=)")
        zoom_in_action.setShortcut(QKeySequence.StandardKey.ZoomIn)
        zoom_in_action.triggered.connect(self._on_zoom_in)
        toolbar.addAction(zoom_in_action)

        # Fit view button
        fit_view_action = QAction(QIcon.fromTheme("zoom-fit-best"), "Fit View", self)
        fit_view_action.setToolTip("Fit view to content (Ctrl+0)")
        fit_view_action.setShortcut(QKeySequence("Ctrl+0"))
        fit_view_action.triggered.connect(self._on_fit_view)
        toolbar.addAction(fit_view_action)

    def _add_search_actions(self, toolbar: QToolBar):
        """Add search-related toolbar actions."""
        # Search button
        search_action = QAction(QIcon.fromTheme("edit-find"), "Search", self)
        search_action.setToolTip("Search cells/nets/pins (Ctrl+F)")
        search_action.setShortcut(QKeySequence.StandardKey.Find)
        search_action.triggered.connect(self._on_find)
        toolbar.addAction(search_action)
```

### 3.3 Toolbar Button Specifications

| Button | Icon (Theme) | Tooltip | Shortcut | Initial State |
|--------|--------------|---------|----------|---------------|
| Open | `document-open` | "Open netlist file (Ctrl+O)" | `Ctrl+O` | Enabled |
| Undo | `edit-undo` | "Undo expansion/collapse (Ctrl+Z)" | `Ctrl+Z` | Disabled |
| Redo | `edit-redo` | "Redo expansion/collapse (Ctrl+Shift+Z)" | `Ctrl+Shift+Z` | Disabled |
| Zoom Out | `zoom-out` | "Zoom out (Ctrl+-)" | `Ctrl+-` | Enabled |
| Zoom In | `zoom-in` | "Zoom in (Ctrl+=)" | `Ctrl+=` | Enabled |
| Fit View | `zoom-fit-best` | "Fit view to content (Ctrl+0)" | `Ctrl+0` | Enabled |
| Search | `edit-find` | "Search cells/nets/pins (Ctrl+F)" | `Ctrl+F` | Enabled |

### 3.4 Icon Requirements

- **Primary source**: System icon theme (`QIcon.fromTheme()`)
- **Fallback**: Bundled SVG icons in `resources/icons/` for systems without theme
- **Size**: 24x24px standard toolbar size
- **Style**: Follow system theme (dark mode compatible)

### 3.5 Visual Design

```python
# Toolbar styling (optional, can use default Qt style)
toolbar.setIconSize(QSize(24, 24))
toolbar.setToolButtonStyle(Qt.ToolButtonStyle.ToolButtonIconOnly)
```

- Icon-only buttons (no text labels for compactness)
- Tooltips show action name + keyboard shortcut
- Visual separators between logical groups
- Disabled buttons shown grayed out

---

## 4. Dependencies

- **Upstream**:
  - E06-F01 (Main Window Shell - toolbar attachment point)
- **Downstream**:
  - E04 (Interaction - undo/redo command integration)
  - E05 (Search - search dialog integration)
  - E02 (Rendering - zoom/fit commands)
- **External**: PySide6 (`QToolBar`, `QAction`, `QIcon`)

---

## 5. Acceptance Criteria

- [ ] Toolbar visible below menu bar
- [ ] All 7 toolbar buttons present and correctly labeled
- [ ] Toolbar buttons have appropriate icons
- [ ] Tooltips display on hover showing action + shortcut
- [ ] Toolbar actions trigger same functions as menu items
- [ ] Undo/Redo buttons initially disabled
- [ ] Undo/Redo buttons enable when actions available
- [ ] Visual separators between button groups
- [ ] Toolbar buttons respond to click events
- [ ] Keyboard shortcuts work when buttons have focus
- [ ] Icons scale appropriately on high-DPI displays

---

## 6. Child Specs

*To be created via `/spec_work E06-F03 --split tasks`*

| ID | Task | Status |
|----|------|--------|

---

## Revision History

| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial feature creation from E06 split |
