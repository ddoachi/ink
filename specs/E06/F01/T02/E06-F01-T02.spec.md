---
id: E06-F01-T02
title: Central Widget Setup
type: Task
priority: P0 (MVP)
status: Draft
parent: E06-F01
created: 2025-12-26
estimated_hours: 3
actual_hours:
effort: Low
tags:
  - ui
  - pyside6
  - canvas
  - presentation
---

# Spec: E06-F01-T02 - Central Widget Setup

## 1. Overview

### 1.1 Problem Statement
The main window needs a central workspace area where the schematic canvas will be displayed. In Qt's `QMainWindow` architecture, the central widget occupies the largest area and cannot be closed or moved, making it ideal for the primary schematic visualization area.

### 1.2 Goals
- Create placeholder `SchematicCanvas` widget class
- Set `SchematicCanvas` as the central widget of `InkMainWindow`
- Ensure central widget fills the main window's workspace area
- Provide proper widget lifecycle integration (parent ownership)

---

## 2. Technical Requirements

### 2.1 SchematicCanvas Placeholder Implementation

**Location**: `src/ink/presentation/canvas/schematic_canvas.py`

```python
from PySide6.QtWidgets import QWidget, QVBoxLayout, QLabel
from PySide6.QtCore import Qt


class SchematicCanvas(QWidget):
    """
    Central canvas widget for schematic visualization.

    This is a placeholder implementation for the main window setup.
    Full rendering functionality will be implemented in E02 (Rendering).
    """

    def __init__(self, parent=None):
        """
        Initialize the schematic canvas.

        Args:
            parent: Parent widget (typically InkMainWindow)
        """
        super().__init__(parent)
        self._setup_ui()

    def _setup_ui(self):
        """Setup placeholder UI."""
        layout = QVBoxLayout(self)

        # Placeholder label for MVP
        placeholder = QLabel("Schematic Canvas Area\n(Rendering implementation: E02)", self)
        placeholder.setAlignment(Qt.AlignmentFlag.AlignCenter)
        placeholder.setStyleSheet("""
            QLabel {
                background-color: #f0f0f0;
                color: #666666;
                font-size: 16px;
                padding: 20px;
            }
        """)

        layout.addWidget(placeholder)
        layout.setContentsMargins(0, 0, 0, 0)
```

### 2.2 Main Window Integration

**Location**: `src/ink/presentation/main_window.py` (modify from T01)

```python
from PySide6.QtWidgets import QMainWindow
from PySide6.QtCore import Qt, QSize
from ink.presentation.canvas.schematic_canvas import SchematicCanvas


class InkMainWindow(QMainWindow):
    """Main application window shell for Ink schematic viewer."""

    def __init__(self):
        """Initialize the main window."""
        super().__init__()
        self._setup_window()
        self._setup_central_widget()  # NEW

    def _setup_window(self):
        """Configure main window properties."""
        self.setWindowTitle("Ink - Incremental Schematic Viewer")
        self.resize(1600, 900)
        self.setMinimumSize(QSize(1024, 768))

    def _setup_central_widget(self):  # NEW METHOD
        """Create and set central schematic canvas."""
        self.schematic_canvas = SchematicCanvas(self)
        self.setCentralWidget(self.schematic_canvas)
```

### 2.3 Directory Structure

Create canvas package:
```
src/ink/presentation/canvas/
├── __init__.py
└── schematic_canvas.py
```

**`__init__.py`** content:
```python
"""Canvas widgets for schematic visualization."""

from ink.presentation.canvas.schematic_canvas import SchematicCanvas

__all__ = ["SchematicCanvas"]
```

---

## 3. Dependencies

### 3.1 Upstream
- Task E06-F01-T01: `InkMainWindow` class must exist

### 3.2 Downstream
- Epic E02 (Rendering): Will replace placeholder with full `QGraphicsView`-based canvas
- Task E06-F01-T04: `main.py` will show window with central widget

### 3.3 External Dependencies
- PySide6: `QWidget`, `QVBoxLayout`, `QLabel`, `QMainWindow`

---

## 4. Acceptance Criteria

### 4.1 Functional Requirements
- [ ] `SchematicCanvas` widget can be instantiated
- [ ] Canvas displays placeholder text clearly
- [ ] Canvas is set as central widget of main window
- [ ] Canvas fills entire central area (no gaps)
- [ ] Canvas parent is set to `InkMainWindow` for memory management
- [ ] Window shows canvas placeholder when displayed

### 4.2 Visual Requirements
- [ ] Placeholder text is centered vertically and horizontally
- [ ] Placeholder background is light gray (#f0f0f0)
- [ ] Placeholder text is readable (dark gray on light gray)
- [ ] No unexpected margins or padding around canvas

### 4.3 Architecture Requirements
- [ ] Canvas class in correct layer (presentation)
- [ ] Canvas class in correct package (`canvas/`)
- [ ] No domain logic in canvas placeholder
- [ ] Canvas accepts parent parameter for Qt ownership

### 4.4 Testing
- [ ] Unit test: Canvas instantiation succeeds
- [ ] Unit test: Canvas has correct parent when created
- [ ] Integration test: Main window with canvas displays correctly
- [ ] Manual test: Placeholder text visible when app launches

---

## 5. Implementation Notes

### 5.1 Design Decisions

**Why placeholder instead of full implementation?**
- Allows main window structure to be completed independently
- Full schematic rendering is complex (Epic E02)
- Follows incremental development approach
- Enables UI layout testing before rendering logic

**Why QWidget instead of QGraphicsView for placeholder?**
- Simpler for placeholder (just needs to show text)
- E02 will replace with `QGraphicsView` for actual rendering
- Keeps dependencies minimal for this task

**Why store canvas as instance variable?**
- Allows future access for connecting signals/slots
- Enables menu commands to interact with canvas
- Standard Qt pattern for child widgets

**Why set parent in constructor?**
- Qt ownership model: parent deletes children automatically
- Prevents memory leaks
- Standard Qt best practice

### 5.2 Testing Strategy

**Unit Tests** (`tests/unit/presentation/canvas/test_schematic_canvas.py`):
```python
import pytest
from PySide6.QtWidgets import QApplication
from ink.presentation.canvas.schematic_canvas import SchematicCanvas


@pytest.fixture(scope="module")
def qapp():
    """Create QApplication for Qt widgets."""
    app = QApplication.instance()
    if app is None:
        app = QApplication([])
    yield app


def test_canvas_creation(qapp):
    """Test canvas can be created."""
    canvas = SchematicCanvas()
    assert canvas is not None


def test_canvas_with_parent(qapp):
    """Test canvas accepts parent widget."""
    from PySide6.QtWidgets import QWidget
    parent = QWidget()
    canvas = SchematicCanvas(parent)
    assert canvas.parent() == parent
```

**Integration Tests** (`tests/integration/presentation/test_main_window_canvas.py`):
```python
import pytest
from PySide6.QtWidgets import QApplication
from ink.presentation.main_window import InkMainWindow


@pytest.fixture(scope="module")
def qapp():
    """Create QApplication for Qt widgets."""
    app = QApplication.instance()
    if app is None:
        app = QApplication([])
    yield app


def test_main_window_has_central_widget(qapp):
    """Test main window has canvas as central widget."""
    window = InkMainWindow()
    assert window.centralWidget() is not None
    assert window.centralWidget() == window.schematic_canvas


def test_canvas_parent_is_main_window(qapp):
    """Test canvas parent is set to main window."""
    window = InkMainWindow()
    assert window.schematic_canvas.parent() == window
```

### 5.3 Future Replacement

**E02 Rendering Implementation**:
The placeholder will be replaced with:
```python
from PySide6.QtWidgets import QGraphicsView

class SchematicCanvas(QGraphicsView):
    """Full schematic rendering canvas with QGraphicsScene."""

    def __init__(self, parent=None):
        super().__init__(parent)
        self.scene = QGraphicsScene(self)
        self.setScene(self.scene)
        # ... full rendering setup
```

---

## Revision History
| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial task creation from E06-F01 split |
