---
id: E06-F01-T01
title: QMainWindow Setup
type: Task
priority: P0 (MVP)
status: Draft
parent: E06-F01
created: 2025-12-26
estimated_hours: 2
actual_hours:
effort: Low
tags:
  - ui
  - pyside6
  - presentation
---

# Spec: E06-F01-T01 - QMainWindow Setup

## 1. Overview

### 1.1 Problem Statement
Create the foundational `QMainWindow` class that serves as the root container for the Ink application. This window provides basic window management functionality (title, sizing, minimize/maximize/close) and establishes the presentation layer foundation.

### 1.2 Goals
- Implement `InkMainWindow` class extending `QMainWindow`
- Set window title to "Ink - Incremental Schematic Viewer"
- Configure default window size (1600x900) and minimum size (1024x768)
- Ensure window respects system decorations and window manager behavior
- Provide clean window lifecycle (initialization, display, close)

---

## 2. Technical Requirements

### 2.1 Class Implementation

**Location**: `src/ink/presentation/main_window.py`

```python
from PySide6.QtWidgets import QMainWindow
from PySide6.QtCore import Qt, QSize


class InkMainWindow(QMainWindow):
    """Main application window shell for Ink schematic viewer."""

    def __init__(self):
        """Initialize the main window."""
        super().__init__()
        self._setup_window()

    def _setup_window(self):
        """Configure main window properties."""
        # Set window title
        self.setWindowTitle("Ink - Incremental Schematic Viewer")

        # Set default size (optimized for 1080p displays)
        self.resize(1600, 900)

        # Set minimum size to prevent unusable small windows
        self.setMinimumSize(QSize(1024, 768))

        # Enable window decorations and standard controls
        self.setWindowFlags(
            Qt.WindowType.Window |
            Qt.WindowType.WindowTitleHint |
            Qt.WindowType.WindowSystemMenuHint |
            Qt.WindowType.WindowMinimizeButtonHint |
            Qt.WindowType.WindowMaximizeButtonHint |
            Qt.WindowType.WindowCloseButtonHint
        )
```

### 2.2 Window Properties

| Property | Value | Rationale |
|----------|-------|-----------|
| **Title** | "Ink - Incremental Schematic Viewer" | Clear app identification |
| **Default Size** | 1600x900 | Optimized for 1080p (1920x1080) displays |
| **Minimum Size** | 1024x768 | Prevents unusable layouts, supports 768p displays |
| **Window Flags** | Standard decorations | Minimize, maximize, close buttons visible |

### 2.3 Window Geometry Calculation

**Default size rationale**:
- 1600x900 leaves room for taskbar on 1080p displays
- Provides ample canvas area (60% = 960px width)
- Accommodates side panels without feeling cramped

**Minimum size rationale**:
- 1024x768 is common minimum for professional tools
- Below this, UI elements become too crowded
- Ensures readability of property text and hierarchy

---

## 3. Dependencies

### 3.1 Upstream
- PySide6: `QMainWindow`, `Qt`, `QSize` classes

### 3.2 Downstream
- Task E06-F01-T02: Sets central widget on this window
- Task E06-F01-T03: Adds dock widgets to this window
- Task E06-F01-T04: Instantiates this window in `main.py`

### 3.3 External Dependencies
- PySide6 >= 6.6.0

---

## 4. Acceptance Criteria

### 4.1 Functional Requirements
- [ ] `InkMainWindow` class creates window without errors
- [ ] Window title displays "Ink - Incremental Schematic Viewer"
- [ ] Window opens at 1600x900 pixels by default
- [ ] Window cannot be resized below 1024x768
- [ ] Window supports minimize, maximize, restore operations
- [ ] Window can be closed via close button or Alt+F4
- [ ] Window follows system theme (light/dark mode)

### 4.2 Visual Requirements
- [ ] Window decorations match system theme
- [ ] Title bar contains app name and standard buttons
- [ ] Window can be moved by dragging title bar
- [ ] Resize handles work on all four sides and corners

### 4.3 Platform Compatibility
- [ ] Works on Linux with X11 window manager
- [ ] Works on Linux with Wayland compositor
- [ ] Respects desktop environment window placement policies

### 4.4 Testing
- [ ] Unit test: Window instantiation succeeds
- [ ] Unit test: Window properties match requirements
- [ ] Manual test: Window displays on screen
- [ ] Manual test: Window controls (minimize/maximize/close) work

---

## 5. Implementation Notes

### 5.1 Design Decisions

**Why QMainWindow instead of QWidget?**
- `QMainWindow` provides built-in support for menu bar, toolbar, status bar, dock widgets
- Designed specifically for application main windows
- Handles window geometry persistence automatically (with QSettings)

**Why explicit window flags?**
- Ensures consistent window decorations across platforms
- Makes expected behavior explicit in code
- Some Linux window managers need explicit flags

**Why 1600x900 instead of maximized?**
- Users often want to keep terminal or documentation visible alongside
- Maximized on first launch is aggressive UX
- Allows users to see other windows/taskbar

### 5.2 Testing Strategy

**Unit Tests** (`tests/unit/presentation/test_main_window.py`):
```python
import pytest
from PySide6.QtWidgets import QApplication
from ink.presentation.main_window import InkMainWindow


@pytest.fixture(scope="module")
def qapp():
    """Create QApplication for Qt widgets."""
    app = QApplication.instance()
    if app is None:
        app = QApplication([])
    yield app


def test_main_window_creation(qapp):
    """Test main window can be created."""
    window = InkMainWindow()
    assert window is not None
    assert isinstance(window, QMainWindow)


def test_window_title(qapp):
    """Test window title is set correctly."""
    window = InkMainWindow()
    assert window.windowTitle() == "Ink - Incremental Schematic Viewer"


def test_window_default_size(qapp):
    """Test window has correct default size."""
    window = InkMainWindow()
    assert window.width() == 1600
    assert window.height() == 900


def test_window_minimum_size(qapp):
    """Test window has correct minimum size."""
    window = InkMainWindow()
    min_size = window.minimumSize()
    assert min_size.width() == 1024
    assert min_size.height() == 768
```

### 5.3 Future Considerations

**Window geometry persistence** (P1):
- Save/restore window size and position using `QSettings`
- Remember maximized state
- Handle multi-monitor configurations

**Custom window decorations** (P2):
- Potentially implement custom title bar for theming
- Would require handling window movement manually

---

## Revision History
| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial task creation from E06-F01 split |
