---
id: E06-F04-T03
title: Zoom Level Display
type: Task
priority: P0 (MVP)
status: Draft
parent: E06-F04
created: 2025-12-26
estimated_hours: 2
actual_hours:
effort: Small
tags:
  - ui
  - statusbar
  - zoom
---

# Spec: E06-F04-T03 - Zoom Level Display

## 1. Overview

### 1.1 Problem Statement

Users need to know the current zoom level of the schematic canvas to understand their view scale. The status bar should display the current zoom percentage and update in real-time whenever the user zooms in, zooms out, or performs fit-to-view operations.

### 1.2 Goals

- Display current zoom level as percentage (e.g., "Zoom: 150%")
- Update zoom display in real-time when viewport zoom changes
- Connect to canvas zoom signals for automatic updates
- Format zoom percentage with no decimal places
- Support zoom range 10% - 1000%

---

## 2. Technical Requirements

### 2.1 Status Update Method

**File**: `src/ink/presentation/main_window.py`

```python
def update_zoom_status(self, zoom_percent: float):
    """Update zoom level in status bar.

    Args:
        zoom_percent: Current zoom level as percentage (e.g., 150.0 for 150%)
    """
    self.zoom_label.setText(f"Zoom: {zoom_percent:.0f}%")
```

### 2.2 Signal Connection

```python
def _connect_status_signals(self):
    """Connect signals to status bar update methods."""
    # Zoom changes from canvas
    if hasattr(self, 'schematic_canvas'):
        self.schematic_canvas.zoom_changed.connect(self.update_zoom_status)
```

### 2.3 Zoom Display Format

| Zoom Level | Display | Notes |
|------------|---------|-------|
| 1.0 (100%) | "Zoom: 100%" | Default/actual size |
| 0.5 (50%) | "Zoom: 50%" | Zoomed out |
| 1.5 (150%) | "Zoom: 150%" | Zoomed in |
| 0.1 (10%) | "Zoom: 10%" | Minimum zoom |
| 10.0 (1000%) | "Zoom: 1000%" | Maximum zoom |
| 1.234 (123.4%) | "Zoom: 123%" | Rounded to integer |

### 2.4 Update Triggers

- Mouse wheel zoom on canvas
- Zoom In button/action (Ctrl++)
- Zoom Out button/action (Ctrl+-)
- Zoom to Fit button/action (Ctrl+0)
- Zoom to Selection
- Programmatic zoom changes

---

## 3. Dependencies

- **Upstream**:
  - E06-F04-T01 (Status Bar Setup - `zoom_label` widget exists)
  - E02-F02 (Schematic Canvas - `zoom_changed` signal)
- **Downstream**: None
- **External**: PySide6 signals/slots

---

## 4. Acceptance Criteria

- [ ] `update_zoom_status()` method implemented
- [ ] Method updates `zoom_label` text with format "Zoom: XXX%"
- [ ] Signal connected to canvas `zoom_changed` signal
- [ ] Zoom display updates immediately on zoom change
- [ ] Percentage formatted with no decimal places (integer)
- [ ] Initial zoom shows "Zoom: 100%" on launch
- [ ] Zoom updates correctly for all zoom operations
- [ ] Display works correctly for full zoom range (10%-1000%)
- [ ] No errors when canvas not yet initialized
- [ ] Unit tests verify correct formatting
- [ ] Integration tests verify signal connection

---

## 5. Testing Strategy

### 5.1 Manual Testing

```python
# Test checklist:
# 1. Launch app - verify "Zoom: 100%" shown
# 2. Scroll wheel up (zoom in) - verify percentage increases
# 3. Scroll wheel down (zoom out) - verify percentage decreases
# 4. Click Zoom In toolbar button - verify increment
# 5. Click Zoom Out toolbar button - verify decrement
# 6. Click Zoom to Fit - verify percentage adjusts
# 7. Zoom to minimum (10%) - verify "Zoom: 10%"
# 8. Zoom to maximum (1000%) - verify "Zoom: 1000%"
```

### 5.2 Unit Tests

```python
# tests/unit/presentation/test_main_window_zoom_status.py

def test_update_zoom_status_100_percent(main_window):
    """Zoom status should show 100% for default zoom."""
    main_window.update_zoom_status(100.0)
    assert main_window.zoom_label.text() == "Zoom: 100%"

def test_update_zoom_status_formats_integer(main_window):
    """Zoom status should format as integer percentage."""
    main_window.update_zoom_status(150.7)
    assert main_window.zoom_label.text() == "Zoom: 151%"

    main_window.update_zoom_status(75.3)
    assert main_window.zoom_label.text() == "Zoom: 75%"

def test_update_zoom_status_min_max(main_window):
    """Zoom status should handle min and max zoom levels."""
    main_window.update_zoom_status(10.0)
    assert main_window.zoom_label.text() == "Zoom: 10%"

    main_window.update_zoom_status(1000.0)
    assert main_window.zoom_label.text() == "Zoom: 1000%"

def test_update_zoom_status_fractional(main_window):
    """Zoom status should round fractional percentages."""
    main_window.update_zoom_status(123.456)
    assert main_window.zoom_label.text() == "Zoom: 123%"
```

### 5.3 Integration Tests

```python
# tests/integration/presentation/test_zoom_status_integration.py

def test_canvas_zoom_signal_updates_status(main_window, schematic_canvas):
    """Canvas zoom changes should trigger status update."""
    # Emit zoom changed signal with 150%
    schematic_canvas.zoom_changed.emit(150.0)

    # Status should update
    assert main_window.zoom_label.text() == "Zoom: 150%"

def test_multiple_zoom_changes(main_window, schematic_canvas):
    """Status should track multiple zoom changes."""
    schematic_canvas.zoom_changed.emit(200.0)
    assert main_window.zoom_label.text() == "Zoom: 200%"

    schematic_canvas.zoom_changed.emit(50.0)
    assert main_window.zoom_label.text() == "Zoom: 50%"

    schematic_canvas.zoom_changed.emit(100.0)
    assert main_window.zoom_label.text() == "Zoom: 100%"
```

---

## 6. Implementation Checklist

- [ ] Implement `update_zoom_status(zoom_percent: float)` method
- [ ] Add canvas zoom signal connection in `_connect_status_signals()`
- [ ] Handle case where canvas not yet initialized
- [ ] Format zoom percentage as integer (no decimals)
- [ ] Verify signal connection in canvas initialization
- [ ] Write unit tests for zoom status formatting
- [ ] Write integration tests for signal connection
- [ ] Test with various zoom levels (min, max, fractional)
- [ ] Verify update latency is acceptable
- [ ] Test zoom operations: wheel, buttons, fit-to-view

---

## 7. Edge Cases

| Edge Case | Behavior |
|-----------|----------|
| Canvas not initialized | Skip signal connection, no errors |
| Rapid zoom changes (wheel scroll) | Display final zoom level (Qt coalesces) |
| Zoom level exactly 100% | Display "Zoom: 100%" (no rounding error) |
| Fractional zoom (e.g., 123.456%) | Round to nearest integer: "Zoom: 123%" |
| Zoom below 10% | Display actual value (canvas should clamp) |
| Zoom above 1000% | Display actual value (canvas should clamp) |

---

## 8. Canvas Integration

**Expected Signal from Canvas**:

```python
# src/ink/presentation/canvas/schematic_canvas.py

from PySide6.QtCore import Signal

class SchematicCanvas(QGraphicsView):
    zoom_changed = Signal(float)  # Emits zoom percentage (e.g., 150.0)

    def set_zoom(self, zoom_factor: float):
        """Set zoom level and emit signal."""
        self.zoom_factor = zoom_factor
        zoom_percent = zoom_factor * 100.0
        self.zoom_changed.emit(zoom_percent)
```

---

## Revision History

| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial task creation from E06-F04 split |
