# Spec: E02-F05 - Pan/Zoom Controls

## Metadata
- **ID**: E02-F05
- **Type**: Feature
- **Priority**: P0 (MVP)
- **Status**: Draft
- **Parent**: [E02](../E02.spec.md)
- **Created**: 2025-12-26

---

## 1. Overview

### 1.1 Problem Statement

Users need intuitive navigation controls to explore different areas of the schematic and focus on regions of interest. Standard pan and zoom controls are essential for any schematic viewer, allowing users to navigate large designs efficiently.

### 1.2 Goals

- Implement smooth mouse-based pan and zoom controls
- Support keyboard shortcuts for zoom operations
- Provide fit-to-view functionality
- Ensure responsive and fluid interaction
- Integrate with LOD system for performance

---

## 2. User Stories

### US-E02-05: Pan and Zoom
**As a** circuit designer
**I want to** pan and zoom the schematic view
**So that** I can navigate to areas of interest

**Acceptance Criteria:**
- [ ] Mouse wheel zooms in/out centered on cursor
- [ ] Click-drag pans the view
- [ ] Fit-to-view command shows all visible content
- [ ] Zoom levels from 10% to 500%

---

## 3. Technical Requirements

### 3.1 Zoom Controls

**Mouse Wheel Zoom:**
- Scroll up: Zoom in (increase zoom factor)
- Scroll down: Zoom out (decrease zoom factor)
- Zoom center: Current cursor position (zoom toward mouse)
- Increment: 10% per scroll notch (configurable)

**Keyboard Shortcuts:**
- `+` or `=`: Zoom in
- `-` or `_`: Zoom out
- `0`: Reset to 100% zoom
- `Ctrl+0`: Fit to view

**Zoom Range:**
- Minimum: 10% (0.1x)
- Maximum: 500% (5.0x)
- Default: 100% (1.0x)

### 3.2 Pan Controls

**Mouse Pan:**
- Middle mouse button drag: Pan view
- Alt + Left mouse drag: Pan view (alternative)
- Hand cursor during pan operation

**Keyboard Pan:**
- Arrow keys: Pan in direction
- Pan increment: 50px per key press

**Auto-Pan:**
- Pan to selected object when selected
- Pan to search result when selected

### 3.3 Fit-to-View

- Calculate bounding box of all visible items
- Scale view to fit bounding box with 10% margin
- Center view on bounding box
- Keyboard shortcut: `Space` or `Ctrl+0`

### 3.4 Qt Graphics View Integration

```python
class SchematicCanvas(QGraphicsView):
    def wheelEvent(self, event: QWheelEvent):
        """Handle mouse wheel zoom."""
        zoom_factor = 1.1 if event.angleDelta().y() > 0 else 0.9
        self.scale(zoom_factor, zoom_factor)
        self.update_lod_level()

    def mousePressEvent(self, event: QMouseEvent):
        """Handle pan initiation."""
        if event.button() == Qt.MiddleButton:
            self.setDragMode(QGraphicsView.ScrollHandDrag)

    def fit_to_view(self):
        """Fit all visible items in view."""
        scene_rect = self.scene().itemsBoundingRect()
        self.fitInView(scene_rect, Qt.KeepAspectRatio)
```

### 3.5 Performance Requirements

- Pan operation: <16ms per frame (60fps)
- Zoom operation: <16ms per frame (60fps)
- Smooth scrolling with no visible lag
- Integration with LOD system to hide details during zoom

---

## 4. Dependencies

- **Upstream**:
  - E02-F01 (Cell rendering)
  - E02-F02 (Layout provides scene bounds)
  - E02-F03 (Net routing)
- **Downstream**:
  - E02-F04 (LOD system responds to zoom changes)
  - E04 (Selection and interaction during pan/zoom)
- **External**:
  - PySide6 QGraphicsView framework

---

## 5. Acceptance Criteria

- [ ] Mouse wheel zooms centered on cursor position
- [ ] Click-drag pans the view smoothly
- [ ] Zoom range enforced (10% to 500%)
- [ ] Fit-to-view calculates correct bounding box
- [ ] Fit-to-view includes 10% margin around content
- [ ] Keyboard shortcuts work for zoom in/out
- [ ] Space bar triggers fit-to-view
- [ ] Pan performance: smooth 60fps during drag
- [ ] Zoom performance: smooth 60fps during scroll
- [ ] Hand cursor shown during pan operation
- [ ] Zoom level persists across operations
- [ ] LOD system triggered on zoom changes

---

## 6. Child Specs

*To be created via `/spec_work E02-F05 --split tasks`*

| ID | Task | Status |
|----|------|--------|

---

## Revision History

| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial feature creation from E02 split |
