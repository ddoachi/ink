---
id: E05
title: Search & Navigation
type: Epic
priority: P0 (MVP)
status: Draft
parent: PRD
prd_sections: ยง8 Search and Navigation
created: 2025-12-26
estimated_hours:
actual_hours:
effort:
tags: []
---

# Spec: E05 - Search & Navigation

## 1. Overview

This epic covers search functionality in Ink - finding cells, pins, and nets by name with real-time filtering, wildcard support, and automatic navigation to search results.

### 1.1 Problem Statement

In a netlist with hundreds of thousands of cells, finding a specific object by name is essential. Engineers often know partial names or patterns and need quick access to matching objects.

### 1.2 Goals

- Search by cell, pin, or net name
- Real-time incremental filtering as user types
- Wildcard pattern support (e.g., `*clk*`, `U_ALU_*`)
- Automatic pan and zoom to selected result
- Search history for quick re-access

---

## 2. User Stories

### US-E05-01: Open Search
**As a** circuit designer
**I want to** quickly open search with Ctrl+F
**So that** I can find objects without leaving keyboard

**Acceptance Criteria:**
- [ ] Ctrl+F opens search dialog/panel
- [ ] Focus immediately in search input
- [ ] Escape closes search

### US-E05-02: Incremental Search
**As a** circuit designer
**I want to** see results as I type
**So that** I can find objects without typing full names

**Acceptance Criteria:**
- [ ] Results update after each keystroke
- [ ] Minimum 2 characters to start search
- [ ] Results show within 100ms of typing
- [ ] Results limited to prevent overwhelming list

### US-E05-03: Wildcard Patterns
**As a** circuit designer
**I want to** use wildcards in search
**So that** I can find groups of related objects

**Acceptance Criteria:**
- [ ] `*` matches any characters (e.g., `*clk*`)
- [ ] `?` matches single character (e.g., `data_?`)
- [ ] Pattern matching is case-insensitive
- [ ] Invalid patterns show error message

### US-E05-04: Navigate to Result
**As a** circuit designer
**I want to** click a result to navigate there
**So that** I can see the object in context

**Acceptance Criteria:**
- [ ] Click on result selects object
- [ ] View pans and zooms to show object
- [ ] Object is expanded if not already visible
- [ ] Selection highlight visible after navigation

### US-E05-05: Search History
**As a** circuit designer
**I want to** access previous searches
**So that** I can quickly repeat common queries

**Acceptance Criteria:**
- [ ] Last 10 searches saved
- [ ] History shown in dropdown
- [ ] Click history item to re-execute
- [ ] Clear history option available

### US-E05-06: Search by Type
**As a** circuit designer
**I want to** filter search by object type
**So that** I can narrow results

**Acceptance Criteria:**
- [ ] Filter options: All, Cells, Pins, Nets, Ports
- [ ] Filter persists across searches
- [ ] Result count shown per type

---

## 3. Technical Requirements

### 3.1 Search Engine

```python
class SearchEngine:
    def search(self, query: str, filters: SearchFilters) -> List[SearchResult]:
        """Execute search with query and filters"""

    def parse_pattern(self, query: str) -> Pattern:
        """Convert wildcard query to regex pattern"""

    def get_history(self) -> List[str]:
        """Get recent search queries"""

@dataclass
class SearchFilters:
    include_cells: bool = True
    include_pins: bool = True
    include_nets: bool = True
    include_ports: bool = True
    max_results: int = 100

@dataclass
class SearchResult:
    object_type: str  # "cell", "pin", "net", "port"
    name: str
    object_id: str
    context: str  # e.g., "Pin of XI123" for pin results
```

### 3.2 Indexing Strategy

```python
class SearchIndex:
    """Pre-built index for fast search"""

    cell_names: Dict[str, Cell]      # name -> cell
    pin_names: Dict[str, List[Pin]]  # name -> pins (many cells have same pin names)
    net_names: Dict[str, Net]        # name -> net
    port_names: Dict[str, Port]      # name -> port

    # For prefix search
    cell_trie: Trie
    net_trie: Trie
```

### 3.3 Search UI Components

```python
class SearchPanel(QWidget):
    search_input: QLineEdit
    filter_buttons: QButtonGroup
    results_list: QListWidget
    history_dropdown: QComboBox

    # Signals
    result_selected: Signal[str]  # object_id
    search_closed: Signal
```

### 3.4 Navigation Integration

```python
class Navigator:
    def navigate_to(self, object_id: str):
        """
        1. Expand object if not visible
        2. Select object
        3. Pan view to center on object
        4. Zoom to appropriate level
        """
```

---

## 4. Dependencies

- **Upstream**:
  - E01 (Data Model - object names and references)
  - E03 (Expansion - expand to show hidden objects)
  - E04 (Interaction - selection and Ctrl+F shortcut)
- **Downstream**: None (terminal feature)

---

## 5. Risks & Mitigations

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Slow search on large netlists | High | Medium | Pre-built index, trie data structure |
| Too many results overwhelm UI | Medium | High | Limit results, show count |
| Wildcard regex performance | Low | Low | Compile patterns once, cache |

---

## 6. Acceptance Criteria (Epic Level)

- [ ] Search results appear within 100ms of typing
- [ ] Wildcard patterns work for `*` and `?`
- [ ] Navigation to result completes in <200ms
- [ ] Search history persists across sessions
- [ ] 10K+ object search completes in <200ms

---

## 7. Child Specs

*To be created via `/spec_work E05 --split features`*

| ID | Feature | Status |
|----|---------|--------|
| [E05-F01](F01/E05-F01.spec.md) | Search Panel UI | Created |
| [E05-F02](F02/E05-F02.spec.md) | Search Engine | Created |
| [E05-F03](F03/E05-F03.spec.md) | Wildcard Matching | Created |
| [E05-F04](F04/E05-F04.spec.md) | Navigation | Created |
| [E05-F05](F05/E05-F05.spec.md) | Search History | Created |

---

## Revision History

| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial epic creation from PRD split |
