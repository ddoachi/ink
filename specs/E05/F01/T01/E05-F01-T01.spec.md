---
id: E05-F01-T01
title: SearchPanel Widget Foundation
type: Task
priority: P0 (MVP)
status: Draft
parent: E05-F01
created: 2025-12-26
estimated_hours: 4
actual_hours:
effort: Medium
tags:
  - ui
  - widget
  - presentation-layer
clickup_task_id: '86evzm2yz'
---

# Spec: E05-F01-T01 - SearchPanel Widget Foundation

## 1. Overview

### 1.1 Problem Statement
Implement the foundational `SearchPanel` widget class that serves as the container for all search UI components. This widget must integrate into the main window layout and provide the basic structure for search functionality.

### 1.2 Goals
- Create `SearchPanel` QWidget class with basic layout
- Add search input field with placeholder text
- Add status label for result count
- Integrate panel into main window bottom panel area
- Set up signal/slot infrastructure for search events

---

## 2. Technical Requirements

### 2.1 SearchPanel Class

**Location**: `/home/joohan/dev/project-ink/ink/src/ink/presentation/panels/search_panel.py`

```python
from PySide6.QtWidgets import QWidget, QVBoxLayout, QHBoxLayout, QLineEdit, QLabel
from PySide6.QtCore import Signal


class SearchPanel(QWidget):
    """Search panel widget for object search and navigation."""

    # Signals
    result_selected = Signal(str)     # Emits object_id when result clicked
    search_closed = Signal()          # Emits when panel is closed
    search_executed = Signal(str)     # Emits when search is triggered (query string)

    def __init__(self, parent=None):
        super().__init__(parent)
        self._init_ui()
        self._connect_signals()

    def _init_ui(self):
        """Initialize UI components."""
        layout = QVBoxLayout(self)

        # Search input row
        search_row = QHBoxLayout()
        search_label = QLabel("Search:")
        self.search_input = QLineEdit()
        self.search_input.setPlaceholderText("Enter object name...")
        search_row.addWidget(search_label)
        search_row.addWidget(self.search_input)

        layout.addLayout(search_row)

        # Status label
        self.status_label = QLabel("No results")
        layout.addWidget(self.status_label)

        # Placeholder for filter buttons (T02)
        # Placeholder for results list (T03)
        # Placeholder for history dropdown (T04)

    def _connect_signals(self):
        """Connect internal signals."""
        self.search_input.returnPressed.connect(self._on_search_triggered)

    def _on_search_triggered(self):
        """Handle search input enter key."""
        query = self.search_input.text().strip()
        if query:
            self.search_executed.emit(query)

    def set_status(self, count: int):
        """Update status label with result count."""
        if count == 0:
            self.status_label.setText("No results")
        elif count == 1:
            self.status_label.setText("1 result found")
        else:
            self.status_label.setText(f"{count} results found")

    def focus_search_input(self):
        """Set focus to search input field."""
        self.search_input.setFocus()
        self.search_input.selectAll()
```

### 2.2 Main Window Integration

**Location**: `/home/joohan/dev/project-ink/ink/src/ink/presentation/main_window.py`

```python
# Add to MainWindow class:

def _init_search_panel(self):
    """Initialize search panel in bottom area."""
    from .panels.search_panel import SearchPanel

    self.search_panel = SearchPanel(self)
    self.search_panel.setVisible(False)  # Hidden by default

    # Add to bottom dock or splitter
    # (Integration depends on existing main window layout)

def show_search_panel(self):
    """Show search panel and focus input."""
    self.search_panel.setVisible(True)
    self.search_panel.focus_search_input()

def hide_search_panel(self):
    """Hide search panel."""
    self.search_panel.setVisible(False)
```

### 2.3 Directory Structure

```
src/ink/presentation/panels/
├── __init__.py
├── search_panel.py         # NEW: SearchPanel widget
├── property_panel.py       # Existing
└── hierarchy_panel.py      # Existing
```

---

## 3. Dependencies

- **Upstream**:
  - PySide6 installed and configured
  - Main window layout structure exists
- **Downstream**:
  - T02 (Type Filter Buttons) will add filter UI to this panel
  - T03 (Results List) will add results widget to this panel
  - T04 (History Dropdown) will add history UI to this panel
  - T05 (Keyboard Integration) will add `Ctrl+F` shortcut handling

---

## 4. Acceptance Criteria

- [ ] `SearchPanel` class created in `presentation/panels/search_panel.py`
- [ ] Search input field with placeholder text "Enter object name..."
- [ ] Status label displays "No results" by default
- [ ] `search_executed` signal emits when Enter key pressed in search input
- [ ] `set_status(count)` method updates status label correctly
- [ ] `focus_search_input()` method focuses and selects input text
- [ ] Panel can be shown/hidden via main window methods
- [ ] Panel integrates into main window bottom area
- [ ] Signal infrastructure ready for future connections

---

## 5. Testing Requirements

### 5.1 Unit Tests

**Location**: `/home/joohan/dev/project-ink/ink/tests/ui/panels/test_search_panel.py`

```python
import pytest
from PySide6.QtWidgets import QApplication
from ink.presentation.panels.search_panel import SearchPanel


@pytest.fixture
def app():
    """Create QApplication instance."""
    return QApplication.instance() or QApplication([])


@pytest.fixture
def search_panel(app):
    """Create SearchPanel instance."""
    return SearchPanel()


def test_search_panel_initialization(search_panel):
    """Test panel initializes with correct default state."""
    assert search_panel.search_input.placeholderText() == "Enter object name..."
    assert search_panel.status_label.text() == "No results"


def test_search_executed_signal(search_panel, qtbot):
    """Test search_executed signal emits on Enter key."""
    with qtbot.waitSignal(search_panel.search_executed, timeout=1000) as blocker:
        search_panel.search_input.setText("test_query")
        search_panel.search_input.returnPressed.emit()

    assert blocker.args[0] == "test_query"


def test_set_status_no_results(search_panel):
    """Test status label with zero results."""
    search_panel.set_status(0)
    assert search_panel.status_label.text() == "No results"


def test_set_status_single_result(search_panel):
    """Test status label with one result."""
    search_panel.set_status(1)
    assert search_panel.status_label.text() == "1 result found"


def test_set_status_multiple_results(search_panel):
    """Test status label with multiple results."""
    search_panel.set_status(25)
    assert search_panel.status_label.text() == "25 results found"


def test_focus_search_input(search_panel):
    """Test focus_search_input method."""
    search_panel.focus_search_input()
    assert search_panel.search_input.hasFocus()
```

---

## 6. Implementation Notes

### 6.1 Design Decisions

1. **Panel Visibility**: Start hidden, shown on demand via `Ctrl+F` (T05)
2. **Layout Structure**: Use `QVBoxLayout` for vertical stacking of components
3. **Signal Pattern**: Emit `search_executed` on Enter key, not on text change (performance)
4. **Status Label**: Simple text-based feedback, no progress bars for MVP

### 6.2 Future Enhancements

- Add clear button (X) to search input
- Add loading spinner for async search
- Add keyboard shortcut hints in UI
- Add search tips/syntax help tooltip

---

## 7. Related Files

**Modified**:
- `/home/joohan/dev/project-ink/ink/src/ink/presentation/main_window.py`

**Created**:
- `/home/joohan/dev/project-ink/ink/src/ink/presentation/panels/search_panel.py`
- `/home/joohan/dev/project-ink/ink/tests/ui/panels/test_search_panel.py`

---

## Revision History
| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2025-12-26 | 0.1 | Claude | Initial task creation from E05-F01 split |
